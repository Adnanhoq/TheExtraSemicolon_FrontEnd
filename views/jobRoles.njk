{% extends "./layouts/main.njk" %}

    {% block pageTitle %}
        Job Roles
    {% endblock %}
    

    {% block links %}
        <link rel="stylesheet" href="/css/jobRolesStyle.css">
    {% endblock %}

{% block content %}
        <div class="container">

            <div class="mainBody">
            {% if theme == 'halloween' %}
            <div class="d-flex justify-content-center w-25 mx-auto gap-2 align-items-center">
                <svg class="w-25" fill="#FF4500" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106.76 122.88"><defs><style>.cls-1{fill-rule:evenodd;}</style></defs><title>witch</title><path class="cls-1" d="M66.8,23.67C76.19,7.47,85.64-.73,94.44.05,86.53,6.17,85.93,18.13,88.71,27l9.62,3.33c-1.45,1.39-6.51,1-9.7,1.21.42,1.46.72,2.81.42,3.6,1.76,1.43,4.31,2.82,4.28,5.17l0,2.93c0,.33-.65.11-1.29-.25-1-.64-2.13-1.78-3-2a2.11,2.11,0,0,0-.69,1.53c-1.19.17-2-.42-2.78-.11a3.62,3.62,0,0,0,2.82,1.16c.34.47-.59,2-.53,2.66a13.59,13.59,0,0,1,1.52,1.52c.5.58,1.89,2.1,1,2.74C88.64,51.79,85,50,83.2,49.26s-3.52-1.54-5.26-2.46c1.54,1.66,4.08,3,2.71,4.14a9.92,9.92,0,0,0-3.34,3c-4.82,7,1.32,10,6.9,13.21l20.27-10.88,2.28,3.77L86.33,70.76h0A9.05,9.05,0,0,1,84.43,77c-1.5-.18-2.57-2.28-3.63-3.34l-7.65,4a5.28,5.28,0,0,1-.22,1.34,8.52,8.52,0,0,1-.56,6.68c-1.89,3.43-10.6,8.33-14.35,11a14.38,14.38,0,0,1,3.34,5.12c10.69,1.79,6.33,7.79-2.53,5.59a27.2,27.2,0,0,1-10.19-5.59c-6-3.48-.79-5.78-1.55-10.4l-7.31,3.84.48.73c.85,1.27,1.49,2.68.16,4a15.19,15.19,0,0,1-1.84,1.36l-.4.29c-1.5,1.07-1.69.55-3.24-.09-2.1,6.92-4.08,14.51-8.65,20.39-.92,1.22-2.31,1.16-4,.14L19.51,120c3.2-2.39,5.62-6,7.38-10.52-3.3,3.75-6.5,7.43-9.18,8.73L14.88,116c.85-1.45,1.5-2.59,1.41-3.46L13.46,114l-3.73-4.61a23,23,0,0,0,10.41-4.22c-4.31,1.36-8,1.85-10.86,1.34-1.55-.06-2.36-.62-2.36-1.7,0-.77.29-.91.92-1.31a9.57,9.57,0,0,1,2.9-1.16A35.09,35.09,0,0,1,7.22,102c-2.79-.06-4.74-2.72-3-5,1.12-1.46,2.35-1,4.13-.89l3.06.11a42.59,42.59,0,0,1-7.62-2.81C1.2,92,1.28,91.92.57,89.16c-.95-3.72-1.14-7,2.92-4.22,8,4.61,16.17,8.72,26.33,8.65a2.34,2.34,0,0,1,.41-2c.61-.79,3.3-2.34,4.3-2.31h0a2.76,2.76,0,0,1,1.83.85l1.07,1.61,6.13-3.22C30.35,83,19.54,68,9.72,47.18c4.93-1.23,39.16,4.9,41.53,2.28l-6.31-3.78c-2.16-2.41,4.64-3.9,8-7.23A65.53,65.53,0,0,0,64,27c-11.57-4.66-8.28-3.61,2.83-3.31Zm7.49,48.72A46.93,46.93,0,0,1,69,64.73l-2.75,3.32a25,25,0,0,1,5.58,5.61l2.42-1.27Z"/></svg>
                    <h1 class = "m-0 p-0 d-flex flex-row justify-content-center mb-3 halloween-text text-nowrap">Job Roles List</h1>
                <svg class="w-25" fill="#FF4500" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106.76 122.88"><defs><style>.cls-1{fill-rule:evenodd;}</style></defs><title>witch</title><path class="cls-1" d="M66.8,23.67C76.19,7.47,85.64-.73,94.44.05,86.53,6.17,85.93,18.13,88.71,27l9.62,3.33c-1.45,1.39-6.51,1-9.7,1.21.42,1.46.72,2.81.42,3.6,1.76,1.43,4.31,2.82,4.28,5.17l0,2.93c0,.33-.65.11-1.29-.25-1-.64-2.13-1.78-3-2a2.11,2.11,0,0,0-.69,1.53c-1.19.17-2-.42-2.78-.11a3.62,3.62,0,0,0,2.82,1.16c.34.47-.59,2-.53,2.66a13.59,13.59,0,0,1,1.52,1.52c.5.58,1.89,2.1,1,2.74C88.64,51.79,85,50,83.2,49.26s-3.52-1.54-5.26-2.46c1.54,1.66,4.08,3,2.71,4.14a9.92,9.92,0,0,0-3.34,3c-4.82,7,1.32,10,6.9,13.21l20.27-10.88,2.28,3.77L86.33,70.76h0A9.05,9.05,0,0,1,84.43,77c-1.5-.18-2.57-2.28-3.63-3.34l-7.65,4a5.28,5.28,0,0,1-.22,1.34,8.52,8.52,0,0,1-.56,6.68c-1.89,3.43-10.6,8.33-14.35,11a14.38,14.38,0,0,1,3.34,5.12c10.69,1.79,6.33,7.79-2.53,5.59a27.2,27.2,0,0,1-10.19-5.59c-6-3.48-.79-5.78-1.55-10.4l-7.31,3.84.48.73c.85,1.27,1.49,2.68.16,4a15.19,15.19,0,0,1-1.84,1.36l-.4.29c-1.5,1.07-1.69.55-3.24-.09-2.1,6.92-4.08,14.51-8.65,20.39-.92,1.22-2.31,1.16-4,.14L19.51,120c3.2-2.39,5.62-6,7.38-10.52-3.3,3.75-6.5,7.43-9.18,8.73L14.88,116c.85-1.45,1.5-2.59,1.41-3.46L13.46,114l-3.73-4.61a23,23,0,0,0,10.41-4.22c-4.31,1.36-8,1.85-10.86,1.34-1.55-.06-2.36-.62-2.36-1.7,0-.77.29-.91.92-1.31a9.57,9.57,0,0,1,2.9-1.16A35.09,35.09,0,0,1,7.22,102c-2.79-.06-4.74-2.72-3-5,1.12-1.46,2.35-1,4.13-.89l3.06.11a42.59,42.59,0,0,1-7.62-2.81C1.2,92,1.28,91.92.57,89.16c-.95-3.72-1.14-7,2.92-4.22,8,4.61,16.17,8.72,26.33,8.65a2.34,2.34,0,0,1,.41-2c.61-.79,3.3-2.34,4.3-2.31h0a2.76,2.76,0,0,1,1.83.85l1.07,1.61,6.13-3.22C30.35,83,19.54,68,9.72,47.18c4.93-1.23,39.16,4.9,41.53,2.28l-6.31-3.78c-2.16-2.41,4.64-3.9,8-7.23A65.53,65.53,0,0,0,64,27c-11.57-4.66-8.28-3.61,2.83-3.31Zm7.49,48.72A46.93,46.93,0,0,1,69,64.73l-2.75,3.32a25,25,0,0,1,5.58,5.61l2.42-1.27Z"/></svg>
            </div>
            {% else %}
                <h1 class = "m-0 p-0 d-flex flex-row justify-content-center mb-3 halloween-text">Job Roles List</h1>
            {% endif %}
                <div class = "d-flex flex-row justify-content-between m-0 p-0">
                    <h3 class="mx-2 mb-2 align-items-center halloween-text">{{ pagination.total }} positions available</h3>
                    <div class="d-flex flex-row-reverse align-items-center gap-1 ">
                        <p class="halloween-text">Items per page</p>
                        <form method="GET" action="" label="aria-label" class="mb-3">
                            <label for="itemsPerPage" style="position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; border: 0; clip: rect(0, 0, 0, 0); overflow: hidden;">Items per Page</label>
                            <select id="itemsPerPage" name="limit" onchange="this.form.submit()">
                                <option value="10" {% if pagination.limit == 10 %}selected{% endif %}>10</option>
                                <option value="25" {% if pagination.limit == 25 %}selected{% endif %}>25</option>
                                <option value="50" {% if pagination.limit == 50 %}selected{% endif %}>50</option>
                                <option value="100" {% if pagination.limit == 100 %}selected{% endif %}>100</option>
                            </select>
                            <button type="submit" style="position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; border: 0; clip: rect(0, 0, 0, 0); overflow: hidden;">Submit</button>
                        </form>
                    </div>
                </div>
                
                <div class="row ">
                    {% for role in jobRoles | sort(attribute='roleId') %}
                        <a href="job-roles/{{role.roleId}}" class="jobCard col-md-4 mb-4">
                            <div id="card{{loop.index}}" class="card w-100 h-100">
                                <div class="card-body">
                                    <h5 class="card-title">{{ role.roleName }}</h5>
                                    <p class="card-text"><strong>Locations:</strong> {{ role.formattedLocations }}</p>
                                    <p class="card-text"><strong>Capability:</strong> {{ role.capability }}</p>
                                    <p class="card-text"><strong>Band:</strong> {{ role.band }}</p>
                                    <p class="card-text"><strong>Closing Date:</strong> {{ role.closingDate | date }}</p>
                                </div>
                            </div>
                        </a>
                    {% endfor %}
                </div>

                <div class="pagination d-flex flex-row justify-content-center">
                    <div class="d-flex flex-row gap-2 align-items-center mx-3">
                        <nav>
                            <ul class="pagination">
                                {% set start_page = pagination.page - 2 %}
                                {% set end_page = pagination.page + 2 %}

                                {% if start_page < 1 %}
                                    {% set start_page = 1 %}
                                {% endif %}

                                {% if end_page > pagination.pages %}
                                    {% set end_page = pagination.pages %}
                                {% endif %}



                                {% for i in range(start_page, end_page + 1) %}
                                    <li class="paginationCard {% if i == pagination.page %}active{% endif %}">
                                        <a class="card p-3 m-1 " href="?page={{ i }}&limit={{ pagination.limit }}">{{ i }}</a>
                                    </li>
                                {% endfor %}
                            </ul>


                        </nav>
                    </div>
                </div>

                <nav class = "d-flex flex-row justify-content-center mb-5 pb-5">
                    <ul class="pagination">
                        {% if pagination.page > 1 %}
                            <li class="page-item">
                                <a class="page-link" href="?page=1&limit={{ pagination.limit }}">First</a>
                            </li>
                        {% else %}
                            <li class="page-item disabled w-75">
                                <span class="page-link">First</span>
                            </li>
                        {% endif %}

                        {% if pagination.page > 1 %}
                            <li class="page-item w-75">
                                <a class="page-link" href="?page={{ pagination.page - 1 }}&limit={{ pagination.limit }}">Previous</a>
                            </li>
                        {% else %}
                            <li class="page-item disabled w-75">
                                <span class="page-link">Previous</span>
                            </li>
                        {% endif %}
                        
                        {% for i in 1..pagination.pages %}
                            <li class="page-item {% if i == pagination.page %}active{% endif %}">
                                <a class="page-link" href="?page={{ i }}&limit={{ pagination.limit }}">{{ i }}</a>
                            </li>
                        {% endfor %}
                            {% if pagination.page < pagination.pages %}
                                <li class="page-item w-75">
                                    <a class="page-link" href="?page={{ pagination.page + 1 }}&limit={{ pagination.limit }}">Next</a>
                                </li>
                        {% else %}
                            <li class="page-item disabled">
                                <span class="page-link">Next</span>
                            </li>
                        {% endif %}
                        
                        {% if (pagination.page >= 1) and (pagination.page != pagination.pages)%}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ pagination.pages }}&limit={{ pagination.limit }}">Last</a>
                            </li>
                        {% else %}
                            <li class="page-item disabled">
                                <span class="page-link">Last</span>
                            </li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
        </div>
{% endblock %}