{% extends "./layouts/main.njk" %}

    {% block pageTitle %}
        Error Page
    {% endblock %}

    {% block scripts %}
    <script type="text/javascript" src="https://unpkg.com/webcam-easy/dist/webcam-easy.min.js"></script>

    {% endblock %}

{% block content %}

<dialog id="dialog">
    <img id="test" width="500" height="600">
    <button id="cancel">Cancel</button>
    <button>Accept</button>
</dialog>

<div class="d-flex justify-content-center">
<div>
<h2>Update your profile picture:</h2>
<video id="webcam" autoplay playsinline width="640" height="480"></video>
<canvas id="canvas" class="d-none"></canvas>

<button id="takePicture">Take Picture</button>
</div>
</div>

<script>

const webcamElement = document.getElementById('webcam');
const canvasElement = document.getElementById('canvas');
const dialog = document.getElementById("dialog");
const snapSoundElement = document.getElementById('snapSound');
const webcam = new Webcam(webcamElement, 'user', canvasElement, snapSoundElement);
const cancelButton = document.getElementById('cancel');

webcam.start()
   .then(result =>{
      console.log("webcam started");
   })
   .catch(err => {
       console.log(err);
   });

document.getElementById('takePicture').addEventListener('click', takePicture);

function takePicture() {
    var picture = webcam.snap();
    document.getElementById("test").src = picture;
    dialog.showModal();
}

document.getElementById('cancel').addEventListener('click',
() => dialog.close());



webcam.stop();


</script>
{% endblock %}